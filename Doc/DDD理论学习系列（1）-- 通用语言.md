# DDD理论学习系列（1）-- 通用语言

​             ![96](https://upload.jianshu.io/users/upload_avatars/2799767/0b0f3fb5-f8b9-4bf4-ac1d-b94468c2e1c8.jpg?imageMogr2/auto-orient/strip|imageView2/1/w/96/h/96) 

​             [圣杰](https://www.jianshu.com/u/39ec0e6b1844)                          

​                                2017.05.06 14:58*               字数 1733             阅读 5471评论 11喜欢 26

> [DDD理论学习系列——案例及目录](https://www.jianshu.com/p/6e2917551e63)

------

# 1.引言

在开始之前，我想我们有必要先了解以下DDD的主要参与者。因为毕竟语言是人说的吗，就像我们面向对象编程一样，那通用语言面向的是？
 DDD的主要参与者：领域专家+开发人员
 领域专家：精通业务的任何人。
 开发人员：开发+测试。
 领域专家擅长某个领域的知识，专注于交付的业务价值。
 开发人员则注重于技术实现。
 开发人员总是想着类、接口、方法、设计模式、架构等。以面向对象的编程思想进行思考，思考如何进行抽象、封装、继承、多态等。而领域专家对软件中的框架、持久化、数据库等没有概念，而这也就导致了他们之间交流的困难性。

那怎么解决交流障碍这个问题呢？

# 2. 通用语言

抛开DDD而言，单从字面意思来理解，我们首先肯定先联想到作为世界使用最多的语言--英语。
 英语之所以能成为通用语言，我想无非是以下几方面：

- 简单易学
- 使用率高
- 国际通用

那DDD中通用语言又是怎样呢？
 首先它也同样要拥有【简单】的特性，这样才便于理解和传播。
 其次，它也要有【通用】、【使用率高】的特性，因为只有在软件开发的过程中，团队范围内所有的参与人员广泛使用，才能准确传递业务规则。

通用语言是团队交流的基础上建立起来的，代码则是基于通用语言来进行业务表达的。

# 3. 举个例子

项目经理安排了一项任务给我：
 圣杰这个补丁处理下【可销控制】这个需求。
 听后，真是一脸懵逼，【可销控制】是什么鬼？

这明显是专业术语，我不懂的专业术语。
 按照DDD对通用语言的定义，【可销控制】就不算通用语言。
 因为只有领域专家知道它的含义，开发人员一脸茫然。

但通用语言是领域专家和开发人员一起创建的，所以我们开个需求会议，来梳理下专业术语背后的含义。

可销控制的应用场景是：
 在ERP中，在做单时对销售员负责的客户进行范围控制。比如，A客户是销售员小李发展过来的，小李希望仅能自己负责对A客户的业务。

这么一解释，是不是明白不少了。但是不是还有几点疑惑？

- 可销范围如何配置？
- 做什么单据时进行可销范围控制？
- 如何进行可销控制？
- 可销控制需不需要参数控制？

经过讨论，得出以下结论：

- 提供专门的【销售员-客户可销控制】界面进行销售员-客户映射数据配置。
- 做销售订单单据时进行可销范围控制
- 在录入销售员后，做单员在选择客户列表时，客户列表中仅显示可销范围配置的客户数据。
- 提供【销售员-客户可销范围控制】系统参数，勾选后才进行可销范围控制。

好了，这下需求理解个七八九了。
 原来可销控制就是销售员-客户销售范围控制。
 咱们用一句话来精简下这个需求：
 可销控制是指销售员所负责客户的范围控制，当勾选了【销售员-客户可销控制】参数后，在做销售订单录入客户数据时，客户列表仅能选择到在【可销控制】列表中为该销售员配置的客户。

经过这么一说明，我们是不是已经理清了【可销控制】这个需求点。

那这种**通过团队交流达成共识的能够简单清晰准确传递业务规则的语言（可以是文字、图片等）**即可称为通用语言。

在通用语言的术语中，名词用于给概念命名，形容词用于描述这些概念，而动词则表示可以完成的操作。

# 4. 通用语言的价值

就像上面所说的那样，通用语言的最大价值是解决了交流障碍问题，使领域专家和开发人员能够协同合作，从而能够确保业务需求的正确表达。

**通用语言包含术语和用例场景，且能够直接反映在代码中。**
 基于通用语言，开发人员能够开发出可读性更好的代码，从而将业务需求准确转化为代码设计。达到DDD的目标代码即设计，设计即代码。通俗的讲，也就是开发人员写的代码领域专家也能看懂。

# 5.通用语言的代码表达

既然开发人员也要基于通用语言进行代码开发，那代码如何体现通用语言呢？
 在《实现领域驱动设计》书中有一个简单的例子（P238），我们一起来看一下：

- 系统必须对User进行认证，并且只有当Tenant（租户）处于激活状态时才能对User进行认证。

上面这个用例就是基于通用语言的用例，简单清楚的说明了业务规则。
 我们先看第一种代码实现：

```
bool anthentic = false;
User user = _userRepository().FindUserByTenantIdAndUserName(tenantId, userName);

if(user!=null)
{
    authentic = user.IsAuthentic(password);
}

return authentic;
```

这段代码完全不能反应通用语言，主要存在以下问题：

1. 这段代码先查找user，再对user进行密码匹配来完成认证。其中`user.IsAuthentic(password);`表示的是“用户是否被认证”的意思，而没有表达出“认证”这个过程，即“对用户进行认证”。
2. 未体现“检查Tenant是否处于激活状态”这个前提条件。

知道问题后，我们可以讲代码略做改动：

```
bool anthentic = false;
Tenant tenant = _tenantRepository.FindTenantById(tenantId);
//检查租户是否激活
if(tenant!=null&&tenant.IsActive){
User user = _userRepository.FindUserByTenantIdAndUserName(tenantId, userName);

if(user!=null)
{
    authentic = tenant.Authenticate(user, password);//租户对用户进行认证
}
}
return authentic;
```

以上代码虽然也不是最终结果，但至少对通用语言进行了体现。通读代码，就能明白业务用例，体现代码即设计这一思想。

喜欢就很好



​                      DDD理论学习 

​           © 著作权归作者所有         

​           举报文章         

​             [               ![96](https://upload.jianshu.io/users/upload_avatars/2799767/0b0f3fb5-f8b9-4bf4-ac1d-b94468c2e1c8.jpg?imageMogr2/auto-orient/strip|imageView2/1/w/96/h/96) ](https://www.jianshu.com/u/39ec0e6b1844)            

圣杰



写了 195594 字，被 2917 人关注，获得了 2133 个喜欢

一名立志成为架构师并为之努力奋斗的程序员！  我的博客园：https://sheng-jie.cnblogs.com 我的GitHub：https://githu