[#4楼](https://www.cnblogs.com/daxnet/archive/2011/12/24/2300169.html#2278864)  2011-12-25 13:23 [徐少侠](https://www.cnblogs.com/Chinese-xu/) [ ](http://msg.cnblogs.com/send/%E5%BE%90%E5%B0%91%E4%BE%A0) 			

我对这个问题的理解是这样的。
使用UML中对象关系的概念：关联、聚合/组合、依赖、泛化（继承）

一般而言，只有符合聚合关系的对象，才能把它们处理成一个在领域中的聚合根对象。
通俗理解：聚合就是附属对象必须出现在主对象中，否则会造成主对象的实体完整性的破坏。

例如：一辆汽车必须和从属于他的引擎发生聚合关系。
缺了引擎，我们不会称剩下的东西为“automobile”

而关联关系，依赖关系和泛化关系则不是。
例如：物理系，和物理系2011（一）班

以主题和回复而言，两者都是“帖子”。
其中回复拥有一个对另一个“帖子”的关联关系。

一个没有上级“帖子”的“帖子”，依然还是一个“帖子”
而一个回复则必须拥有一个主题。

这里对楼主的UML的一个建议，就是不要用聚合的图形来表示post和reply之间的关系。
用空心菱形把，因为我感觉这里是一个关联关系。

具体到代码级别：
一个post不带有任何reply的引用字段或实体字段
而每个reply，必须有一个post的key引用，而不是post实体

我们可以对所有reply的postkey进行查找操作。
但是当我们需要知道某个reply所涉及的post，则需要用这个reply的postkey字段到post的repository里去取。

此时，post的物理死亡，需要一个跨两个repository的事务来完成。

> 
>
> 
>
> https://www.cnblogs.com/daxnet/archive/2011/12/24/2300169.html